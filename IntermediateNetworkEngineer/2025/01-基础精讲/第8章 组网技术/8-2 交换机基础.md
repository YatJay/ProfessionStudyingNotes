## 8-2 交换机基础

### 交换机分类

1. 根据交换方式分

| 交换方式                                | 描述                                                         | 优点                                                         | 缺点                                                         |
| --------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| <font color="red">存储转发式交换</font> | 完整接收数据帧，缓存、验证、碎片过滤，然后转发。             | **可以提供差错校验和非对称交换**。                           | <font color="red">延迟大</font>。                            |
| <font color="red">直通式交换</font>     | 输入端口扫描到目标地址后立即开始转发。                       | **延迟小、交换速度快**。                                     | **没有检错能力，不能实现非对称交换**。                       |
| <font color="red">碎片过滤式交换</font> | 开始转发前先检查数据包的长度**是否够64字节**，如果小于64个字节则丢弃；如果大于等于64个字节，则转发该包。 | 减少了冲突碎片的传播，相比直通式交换具有一定的错误检测能力。 | 相比存储转发式交换，其错误检测能力有限，延迟略高于直通式交换。 |

存储转发式交换（Store andForward））完整接收数据帧，缓存、验证、碎片过滤，然后转发。

优点：可以提供差错校验和非对称交换。缺点：延迟大。

直通式交换（Cut-through）输入端口扫描到目标地址后立即开始转发。

优点：延迟小、交换速度快。缺点：没有检错能力，不能实现非对称交换。

碎片过滤式交换（FragmentFree）开始转发前先检查数据包的长度是否够64字节，如果小于64个字
节，说明是冲突碎片，则丢弃；如果大于等于64个字节，则转发该包。

2. 根据交换的协议层划分
   - 二层交换机
   - 三层交换机
   - 多层交换机。
3. 根据交换机结构划分
   - 固定端口交换机
   - 模块化交换机。

2. 根据配置方式划分
   - 堆叠交换机
   - 非堆叠交换机。

2. 根据管理类型划分
   - 网管交换机
   - 非网管交换机
   - 智能交换机。
3. 层次结构划分
   - 核心交换机
   - 汇聚交换机
   - 接入交换机。

![image-20250319233848413](https://img.yatjay.top/md/20250319233848463.png)

### 华为横向虚拟化CSS+iStack

框式交换机堆叠多用于网络核心层或汇聚层，而盒式交换机堆叠一般用于汇聚层或接入层。

![image-20250319234341682](https://img.yatjay.top/md/20250319234341731.png)

### 多台设备堆叠和集群

使用堆叠、集群技术将独立的交换机虚拟化成一台逻辑的交换机，一般接入、汇聚层盒式交换机采用堆叠技术汇聚、核心层交换机采用集群技术。

在逻辑交换机之间使用链路聚合技术，无需部署STP、VRRP实现高可靠性。

实现高可靠性的同时设备之间的链路可以同时传输流量，链路利用率得以提升。

![image-20250319234419728](https://img.yatjay.top/md/20250319234419772.png)

#### 堆叠的优势

1. <font color="red">扩展端口数量</font>。当接入的用户数增加到原交换机端口密度不能满足接入需求时，可以通过使用堆叠系统或在原有的**堆叠系统中增加新的交换机**而得到满足。
2. <font color="red">简化组网，增加可靠性</font>。逻辑上把多台设备虚拟成一台设备，简化运维，方便管理。同时，单台设备故障，不影响堆叠系统，
3. <font color="red">扩展系统处理能力和带宽</font>。E当核心交换机转发能力不能满足需求时，可以增加新交换机与原交换机组成堆叠系统来实现。例如：若一台交换机转发能力为64M pps，则通过增加一台交换机进行扩展后，整个堆叠设备的转发能力为128M pps。需要强调的是，是整个堆叠系统的转发能力整体提高，而不是单个交换机的转发能力提高。

#### 堆叠的劣势

1. 堆叠都是私有协议，不支持跨厂商设备堆叠。
2. 需要单独购买堆叠线缆。(现在最新的用光纤也能实现堆叠，考试可以写)
3. 存在一定资源浪费，特别高端设备，如果2台核心都配置双引擎，堆叠后只有1个引擎工作。
4. 如果堆叠系统升级或重启，一般会有20～60s的业务中断。
5. 可靠性风险：控制层面统一后，相当于把鸡蛋放在一个篮子里，如果整个逻辑设备的控制平面出现问题（比如说路由表被人攻击破坏），就有可能导致整机瘫痪，影响的范围大。

#### 堆叠三种角色

Master：一个堆叠系统中，<font color="red">用有且仅有一个主</font>

Standby：如果主出现故障，则由备承担主的工作，一个堆叠系统中，<font color="red">有且仅有一个备</font>

Slave：一个堆叠系统中，除了主和备外，<font color="red">剩余成员都是从设备</font>

![image-20250319234630581](https://img.yatjay.top/md/20250319234630627.png)

### 交换机性能参数

端口类型：RJ45电口、光口（GBIC<font color="red">/SFP/SFP+/QSFP</font>+/SFP28）、**扩展插槽数量**。

传输模式：半双工、全双工。

交换容量：<font color="red">端口数\*端口速率\*2</font>。

包转发率：单位时间内发送64字节数据包的个数1000Mbps/8/(64+8+12)=1.488Mpps。

MAC地址数：交换机MAC地址表中可以存储最大的MAC地址数量。

VLAN表项：交换机最大支持VLAN数量，现在都是<font color="red">4094个</font>。

![image-20250319234742826](https://img.yatjay.top/md/20250319234742915.png)

### 例题

#### 例题1

![image-20250319234817209](https://img.yatjay.top/md/20250319234817248.png)



#### 例题2

![image-20250319234825665](https://img.yatjay.top/md/20250319234825718.png)

#### 例题3

![image-20250319234833746](https://img.yatjay.top/md/20250319234833782.png)



#### 例题4

![image-20250319234842937](https://img.yatjay.top/md/20250319234842983.png)



#### 例题5

![image-20250319234858815](https://img.yatjay.top/md/20250319234858857.png)