## 3-2 CSMA/CD

### 局域网的架构

局域网标准由IEEE机构制定，其标准代号为802，一般数据链路层都是由IEEE进行规范，网络层则由RFC机构进行规范(RFC文档)

早期将数据链路层划分为两个子层：

- 逻辑链路控制子层LLC：用于向上对接网络层
- MAC子层：物理介质访问控制层，更偏向于向下对接物理层

![image-20250223154044634](https://img.yatjay.top/md/20250223154044678.png)

最早的局域网有许多标准：如以太网、令牌总线、令牌环网、光纤环、无线局域网、等等

时至今日，随着其他技术淘汰，现在最常用的标准是：

- <font color=red>802.3 CSMA/CD标准，即以太网</font>
- <font color=red>802.11 标准，即无线局域网</font>

### 局域网的拓扑结构

局域网的主要特征由网络的拓扑结构、所采用的协议类型，以及介质访问控制方法决定。

局域网的拓扑结构是指连接网络设备的传输介质的铺设形式，局域网的拓扑结构主要有**星型、总线**
**型、环型和混合型**。

![image-20250223154319151](https://img.yatjay.top/md/20250223154319202.png)

### CSMA(CarrierSense MultipleAccess)

#### CSMA/CD简介

CSMA/CD：对**总线型、星型（中间用HUB的星形网络，用交换机的话不影响）和树型**拓扑**访问控制协议**是CSMA/CD，中文译作载波监听多点接入冲突检测，CSMA/CD是**共享型网络中解决冲突的技术**

- Carrier Sense[载波监听]
- MultipleAccess[多点接入]
- Collision Detection[冲突检测]

基本原理：发送数据之前，先监听信道上是否有人在发送。若有，说明信道正忙，否则说明信道是空
闲的，然后根据**预定的策略**决定：

1. 若信道空闲，是否立即发送。

2. 若信道忙，是否继续监听。

如果连续发生**16次**碰撞后，认为网络繁忙有问题，就不再尝试发送。上面提到的预定的策略正是CSMA的三种监听算法

#### 非坚持型：后退随机时间

（1）非坚持型监听算法：后退随机时间。如果空闲，则发送；否则后退，再试(发现厕所有人，我回去等半个小时再来)

由于随机时延后退，从而**减少了冲突的概率**。问题是因为后退而使信道闲置一段时间，这使**信道的利用率**
**降低**，而且**增加了发送时延**

#### 1-坚持型：继续监听，不后退等待

（2）1-坚持型监听算法：继续监听，不等待。只要信道变闲，就可立即发送；如果冲突，后退再继续监听(发现厕所有人，就在厕所门口等着即监听厕所状态)

有利于抢占信道，减少信道空闲时间。但是，多个站同时都在监听信道时必然会发生冲突

**冲突概率和利用率都高 (双高)**

#### P-坚持型

（3）P-坚持型监听算法：若信道空闲并不马上发，而是以概率P发送，以概率(1-P)延迟一个时间单位，P大小可调整(是上面2种策略的结合)

![image-20250223154603331](https://img.yatjay.top/md/20250223154603374.png)

#### 例题

![image-20250223160039824](https://img.yatjay.top/md/20250223160039869.png)

解析：1-坚持型监听算法的特点是双高：介质利用率和冲突概率都高

###  CD(Collision Detection)冲突检测原理

载波监听只能<font color="red">减小冲突的概率，不能完全避免冲突</font>。

若帧比较长或两个帧发生**冲突还继续发送，会浪费网络带宽**。为改进带宽的利用率，发送站应采取<font color="red">边发边听</font>的冲突检测方法，即：

1. 发送期间同时接收，并把接收的数据与站中存储的数据进行比较。

2. 若比较结果一致，说明没有冲突，重复（1）。

3. 若比较结果不一致，说明<font color="red">发生了冲突，立即停止发送</font>，并发送一个简短的干扰信号(Jamming),使所有站都停止发送。

4. 发送Jamming信号后，<font color="red">等待一段随机长的时间</font>，重新监听，再试着发送。

对总线型、星型和树型拓扑访问控制协议是CSMA/CD(Carrier Sense MultipleAccess/Collision Detection，载波侦听多路访问/冲突检测）

带冲突检测的监听算法<font color="red">把浪费带宽的时间减少到检测冲突的时间</font>。

### 例题

#### 例题1

![image-20250223185349469](https://img.yatjay.top/md/20250223185349503.png)

#### 例题2

![image-20250223185359942](https://img.yatjay.top/md/20250223185359975.png)

#### 例题3

![image-20250223185417822](https://img.yatjay.top/md/20250223185417871.png)

#### 例题4

![image-20250223185430169](https://img.yatjay.top/md/20250223185430201.png)