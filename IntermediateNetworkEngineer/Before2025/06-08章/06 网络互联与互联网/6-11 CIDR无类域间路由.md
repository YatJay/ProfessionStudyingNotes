# 6-11 CIDR无类域间路由(即超网)

## VLSM可变长度子网掩码回顾

VLSM(Variable Length Subnet Mask)——变长子网掩码：通过将一个大的网络划分成n个小的子网，从而提高IP地址利用率，节约IP地址

有效利用IP地址

- 分给用户使用的IP地址子网，其子网掩码较短，比如：172.16.10.0/24，网络位为24位，主机位为8位，存在254个可分配IP地址，可分配给用户主机使用
- 用于两路由器之间连接的子网，其子网掩码较长，比如：172.16.10.0/30，网络位为30位，主机位为2位，存在2个可分配IP地址，只需分给相连的两个路由器端口

![image-20230914222742507](https://img.yatjay.top/md/image-20230914222742507.png)

![image-20230914222800710](https://img.yatjay.top/md/image-20230914222800710.png)

## 无类域间路由CIDR

CIDR（无类域间路由，超网Classless Inter-Domain Routing)，又称超网或路由聚合

**路由聚合**：很多个网络聚合成为一条路由，减少路由器的压力

如下图所示，A路由器的路由表中存在4条路由记录，通过路由聚合之后传递给B的则只有1条路由记录，减少了路由器的压力

![image-20230914222943389](https://img.yatjay.top/md/image-20230914222943389.png)

从而，B路由器的路由表可以是200.200.192.0/22，而不是像A那样显示4条路由

### 路由聚合方法

把几条近似路由写成二进制形式，观察哪些二进制位完全一致，则从该二进制位处进行聚合

如上图中4条路由记录的二进制位，前22位完全一致，则4条记录可以聚合成为1条记录

再将聚合之后的二进制位写成点分十进制形式

![image-20230914223221647](https://img.yatjay.top/md/image-20230914223221647.png)

### 例题

![image-20230914223627463](https://img.yatjay.top/md/image-20230914223627463.png)

解析：如下图所示

![image-20230914223641511](https://img.yatjay.top/md/image-20230914223641511.png)

## 无类域间路由CIDR的作用

- **减小骨干路由器表项压力**：(尤其对于因特网骨干路由器，若不进行路由聚合，其路由表项巨大，必须做CIDR路由聚合)

- **缓解IP地址耗尽**：划分子网在一定程度上缓解了因特网在发展中遇到的困难，但是**数量巨大的C类网**因为其**地址空间太小**并**没有得到充分使用**(笔者注：共有2^21^个(约为209万余个)C类网络，如果将C类地址全部分配，对于互联网骨干路由器的路由表项压力巨大，不敢随意分配C类地址)，而因特网的IP地址仍在加速消耗，整个**IPv4地址空间面临全部耗尽的威胁**。引入CIDR之后，许多C类网络可以聚合为少量路由表项，从而可以继续分配C类地址，一定程度上CIDR间接地减缓了IP地址耗尽

![image-20230914223835146](https://img.yatjay.top/md/image-20230914223835146.png)
