# 6-4 网络和交换机发展过程

## 网络及网络设备演进历史

### ARPnet阿帕网

**1946年2月14日**，冯·诺依曼研制世界第一台电子计算机ENIAC问世。

**1969年11月**，美国国防部建立ARPAnet网络，只有4个结点，加利福尼亚州大学洛杉矶分校、加州大学圣巴巴拉分校、斯坦福大学（这三所大学都在加州，硅谷亦在加州）、犹他州大学四所大学的4台大型计算机，这是现代计算机网络的雏形。

### 从中继器到集线器HUB

#### 主机直连

最早的计算机网络就事主机直接连接

![image-20230304162819737](https://img.yatjay.top/md/image-20230304162819737.png)

#### 中继器

直连主机的网络无法远距离传输，**中继器**作为**物理层**设备，可以将**信号放大**使得完成更远距离传输

![image-20230304162833098](https://img.yatjay.top/md/image-20230304162833098.png)

#### 集线器

随着越来越多设备需接入网络，出现了另一个**物理层**设备**集线器HUB**，集线器也可以**放大信号**

![image-20230304163021542](https://img.yatjay.top/md/image-20230304163021542.png)

通过中继器和集线器，形成了最初的局域网

![image-20230304163033259](https://img.yatjay.top/md/image-20230304163033259.png)

#### 集线器带来的困扰

**集线器工作原理**：从一个接口进入的数据，进行信号放大之后，**向其它所有接口进行泛洪(广播)**

![image-20230304163303623](https://img.yatjay.top/md/image-20230304163303623.png)

如果将两个集线器进行连接

![image-20230304163558540](https://img.yatjay.top/md/image-20230304163558540.png)

则会带来问题——现场环路，形成广播风暴，影响通信效率

![image-20230304163748839](https://img.yatjay.top/md/image-20230304163748839.png)

因此我们可以总结出集线器带来的两个问题

1. 产生环路，形成广播风暴，影响通信效率
2. 由于向其他接口进行广播，则会数据扩散，产生安全威胁，比如早期QQ用户名密码传输使用明文，如果使用集线器，则可在同一个集线器下的另一台终端抓包获取用户名密码

### 划时代的设备——交换机

**交换机工作原理**：数据交换**不再使用泛洪方式**，而是使用**专用交换通道**（后续详细介绍）

![image-20230304164342185](https://img.yatjay.top/md/image-20230304164342185.png)

扩展：最早的交换机由3com公司发明，3com即是H3C华三公司的母公司

### 网络层设备——路由器

由于有了**隔离广播域**的需求，交换机**引入了VLAN**虚拟局域网

划分VLAN之后的VLAN10和VLAN20默认不能进行通信，各个VLAN之间需要使用三层设备**路由器来实现跨VLAN通信**

![image-20230304164630969](https://img.yatjay.top/md/image-20230304164630969.png)

#### 三层交换机——把路由器功能集成到了交换机内部

交换机内部既有交换模块，又有路由模块，相当于是路由器和交换机的组合体，在三层交换机内部即可实现VLAN之间的通信

![image-20230304170429089](https://img.yatjay.top/md/image-20230304170429089.png)

##### 路由器和交换机的区别

https://zhuanlan.zhihu.com/p/30483794

>**要知道路由器和三层交换机的区别，就先搞明白他们的应用场景，如图**：
>
![img](https://img.yatjay.top/md/v2-582a9a0e050ceb85a35ac2df5938387f_1440w.webp)
>
>
>
> 常见园区网中，路由器用于网络出口（几万人的园区，可能只有2台出口路由器）
>
> 三层交换机用于汇聚节点和核心（几万人的园区，有几十台 三层交换机做汇聚/核心交换机）
>
>一些基础功能，如OSPF/BGP/MPLS，路由器和三层交换机均能很好支持。
>
>
>正是由于路由器和三层交换机使用位置的不同，塑造他们的差异化：
>
>1. **接口形态**：路由器用于连接运营商，运营商甩给用户的线路可以有ATM、POS、CPOS、以太网>等多种线路，路由器都需要支持；而我们平时所说的三层交换机一般只支持以太网接口，接口数量>非常多（毕竟用在园区内部）
>2. **功能**：路由器用于园区出口，承担访问互联网的功能，支持NAT/IPSEC等功能；这些功能90%的三层交换机是不支持的。
>3. **性能**：三层交换机组建的是内部高速路，到了出口路由器就进入国道了。交换机上10G/40G/100G接口都可以灵活扩展；而一般园区网出口路由器不需要太高性能，够用即可，就算插个100G板卡，也买不起运营商100G链路呀，太贵！
>4. **成本**：高端路由器比高端交换机价格贵，路由器单接口成本也更高。支持500个接口的交换机很多，但能有500个接口的路由器已经非常贵了。
>5. **厂商情况**：思科是做路由器起家，后来收购了Catalyst，开始出交换机；华为重点运营商，运营商/金融/公安这类纵向网，都是路由器大户，所以至今华为的路由器也比交换机做得好；新华三数通优势在交换机，毕竟全球第一款交换机就是他的前 前 前 东家3COM公司搞出来的；迈普以前重点行业是金融、运营商低端设备，路由器做得比交换机好；锐捷重点校园网，应该是最大的园区网了吧，也是交换机起家。



## 网络演进总结——交换机的演进过程

### 第一代：交换机前身：中继器、集线器

### 第二代：二层交换机：基于MAC地址进行转发

### 第三代：三层交换机：集成路由功能

### 第四代：多业务交换机(对核心交换机通过插板卡实现4~7层业务)

第四代：多业务交换机(对核心交换机通过插板卡实现多种功能)：FW(防火墙模块板卡)/AC(行为控制模块板卡)/LB/WS(无线模块板卡)，即通过在交换机上插板卡实现传输层、应用层功能（4~7层多业务交换机）等，华三测板卡最丰富，一般作为控标项；锐捷板卡最少，带*实际上是没有的；华为有些板卡功能是通过软件授权实现，不需要插板卡

![image-20230911215329874](https://img.yatjay.top/md/image-20230911215329874.png)

### 第五代：可编程交换机SDN

第五代：可编程交换机：SDN，一般企业网很少用

- SDN部署:Google、AT&T		
- CISCO N9K: ACI(Application Centric Infrastructure)		
- 以应用为中心的基础设施		
- HW127/128∶敏捷网络，敏捷开发、H3C 125、锐捷N18K这些设备都支持SDN

![image-20230911215349235](https://img.yatjay.top/md/image-20230911215349235.png)

**传统交换机**：每台设备具有转发层面（数据转发）和控制层面（跑路由协议，路由协议用来生成转发表）

**SDN架构**：交换机只保留转发层面，只负责数据转发，其他功能通过SDN控制器来实现，不需要运行路由协议了，所有的转发表通过SDN控制器来下发。另外，SDN控制器也可以通过编程实现各种功能NFV如防火墙、负载均衡等

一般的企业网络或园区网络不会使用SDN架构，数据中心会使用

![image-20230911215653269](https://img.yatjay.top/md/image-20230911215653269.png)

## 数通设备总结

![image-20230304171901730](https://img.yatjay.top/md/image-20230304171901730.png)

注意理解：

- 网桥就是2个口的二层交换机
- 中继器就是2个口的集线器