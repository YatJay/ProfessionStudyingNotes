## 5-8 TCP和UDP协议

### 5-8-4 重点协议与端口总结

#### TCP/UDP端口号

源端口随机分配，目标端口使用知名端口。

应用客户端使用的源端口一般为系统中未使用的且大于1024。

目的端口号为服务器端应用服务器的进程，如telnet为23。

![image-20250305194206127](https://img.yatjay.top/md/20250305194206156.png)

##### 例题

![image-20250305194336494](https://img.yatjay.top/md/20250305194336526.png)

#### 网络协议

<font color="red">记忆↓</font>

##### 邮件相关协议

| 协议名称 | 端口号 | 传输协议 | 功能说明                                    |
| -------- | ------ | -------- | ------------------------------------------- |
| SMTP     | 25     | TCP/UDP  | 邮件发送（简单邮件传输协议）<br>通常使用TCP |
| POP3     | 110    | TCP      | 邮件接收（邮局协议版本3）                   |
| IMAP     | 143    | TCP      | 邮件同步（互联网邮件访问协议）              |

##### TCP协议常用端口

| 协议名称 | 端口号 | 功能说明                                     |
| -------- | ------ | -------------------------------------------- |
| FTP      | 21     | 文件传输控制连接                             |
| SSH      | 22     | 安全远程登录/文件传输                        |
| Telnet   | 23     | Internet远程登录服务的标准协议和主要方式     |
| SMTP     | 25     | 邮件发送（简单邮件传输协议）<br/>通常使用TCP |
| HTTP     | 80     | 网页数据传输（超文本传输协议）               |
| POP3     | 110    | 邮件接收（邮局协议版本3）                    |
| IMAP     | 143    | 邮件同步（互联网邮件访问协议）               |
| BGP      | 179    | 边界网关协议                                 |
| HTTPS    | 443    | 加密网页传输（HTTP over SSL）                |
| RIP      | 520    | 路由信息协议（部分实现使用TCP）              |
| RDP      | 3389   | 远程桌面                                     |

##### UDP协议常用端口

助记：RSTDD(“扔石头蛋蛋”)

| 协议名称 | 端口号  | 功能说明                                             |
| -------- | ------- | ---------------------------------------------------- |
| DNS      | 53      | 域名解析（通常优先UDP）                              |
| DHCP     | 67/68   | 动态主机配置协议（服务端/客户端）                    |
| TFTP     | 69      | Trivial File Transfer Protocol（简单文件传输*协议*） |
| SNMP     | 161/162 | 简单网络管理协议（客户端/服务端）                    |
| IKE      | 500     | Internet密钥交换协议                                 |
| RIP      | 520     | 路由信息协议（主流实现使用UDP）                      |

#### 主流协议魔力图

<font color="red">记忆↓</font>

![image-20250305195202320](https://img.yatjay.top/md/20250305195202384.png)

#### 例题

##### 例题1

![image-20250305195817489](https://img.yatjay.top/md/20250305195817526.png)

解析：ICMP是直接封装在IP里面，IP可以封装在UDP或者TCP

##### 例题2

![image-20250305195825527](https://img.yatjay.top/md/20250305195825568.png)

解析：

- SNMP基于UDP，可靠性差，但效率高；
- SNMPv2c没有增加安全性，SNMPv3主要增加了安全性。