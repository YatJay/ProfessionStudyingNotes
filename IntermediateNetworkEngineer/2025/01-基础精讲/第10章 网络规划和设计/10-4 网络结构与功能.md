## 10-4 网络结构与功能

### 局域网结构类型

#### 单核心局域网

下图是一个单核心局域网架构，用户终端通过接入交换机连接至核心交换机，服务器直接连接核心交换机，若服务器较多，需要将服务器通过服务器接入交换机连接至核心交换机

![image-20250321225334096](https://img.yatjay.top/md/20250321225334136.png)

#### 单核心局域网特点

1. 核心交换设备在实现上多采用二层、三层交换机或多层交换机。(废话，意思是说网络规模小，用哪种核心交换机都可以)
2. 如采用三层或多层设备，可以划分成多个VLAN，在VLAN内只进行数据链路层帧转发。
3. 网络内各VLAN之间访问需要经过核心交换设备，并且只能通过网络层数据包转发方式实现。
4. 网络中除核心交换设备以外不存在其他的带三层路由功能的设备。
5. 核心交换设备与各VLAN设备间采用1000M及以上以太网连接。(*下面6、7、8是优点，记忆*)
6. **节省设备投资。**
7. **网络结构简单。**(运维就简单，不用担心搞出环线)
8. **部门局域网络访问核心局域网以及相互之间访问效率高。**
9. 在核心交换设备端口富余的前提下，部门网络接入较为方便。
10. 网络地理范围小，要求部门网络分布比较紧凑。(*下面11、12、13是缺点，记忆*)
11. <font color="red">核心交换机是网络的故障单点，容易导致整网失效。</font>
12. <font color="red">网络的扩展能力有限。</font>
13. <font color="red">对核心交换设备的端口密度要求较高。</font>
14. 除非是规模较小的网络，否则桌面用户不直接与核心交换设备相连，也就是核心交换机与用户计算机之间应存在接入交换机。

### 双核心局域网

如下图所示，用户终端通过接入交换机连接至核心交换机，每台接入交换机都要**双上行**连接核心交换机，服务器也是双上行连接核心交换机

![image-20250321225323066](https://img.yatjay.top/md/20250321225323091.png)

#### 双核心局域网特点

1. 核心交换设备在实现上多采用三层交换机或多层交换机。
2. 网络内各VLAN之间访问需要经过两台核心交换设备中的一台。
3. 网络中除核心交换设备以外不存在其他的具备路由功能的设备。
4. **核心交换设备之间运行特定的网关保护或负载均衡协议，例如HSRP、VRRP和GLBP 等。**(需要掌握VRRP，华为配置专题重点讲解，HSRP和GLBP是思科的协议。除了使用这种负载均衡协议，还可以使用横向虚拟化或堆叠或集群技术)
5. 核心交换设备与各VLAN设备间采用1000Mb及以上以太网连接。(*下面6、7、8是优点，记忆*)
6. **网络拓扑结构可靠。**
7. **路由层面可以实现无缝热切换。**
8. **部门局域网络访问核心局域网以及相互之间多条路径选择可靠性更高。**
9. 在核心交换设备端口富余的前提下，部门网络接入较为方便。(*下面10、11是缺点，记忆*)
10. <font color="red">设备投资比单核心局域网结构的投资高。</font>
11. <font color="red">对核心路由设备的端口密度要求较高。</font>
12. 核心交换设备和桌面计算机之间存在接入交换设备，接入交换设备同时和双核心存在物理连接。
13. 所有服务器都直接同时连接至两台核心交换机，借助网关保护协议(VRRP)实现桌面用户对服务器的高速访问。

### 环形局域网结构

环形局域网结构，运营商城域网、校园网使用较多

![image-20250321225406678](https://img.yatjay.top/md/20250321225406713.png)

#### 环形局域网结构特点

1. 核心交换设备在实现上多采用三层交换机或多层交换机。
2. 网络内各VLAN之间访问需要经过RPR环。*(下面是优点)*
3. **RPR技术能提供MAC层的50ms自愈时间，能提供多等级、可靠的QoS服务。**(环网收敛时间较短)
4. **RPR有自愈保护功能，节省光纤资源。**
5. RPR协议中没有提及相交环、相切环等组网结构，当利用RPR组建大型城域网时，多环之间只能利用业务接口进行互通，不能实现网络的直接互通，因此它的<font color="red">组网能力与SDH、MSTP相比较弱</font>
6. 由两根反向光纤组成环形拓扑结构。其中，一根顺时针，一根逆时针，节点在环上可以从两个方向到达另一节点。每根光纤可以同时用来传输数据和同向控制信号，RPR环双向可用。
7. **利用空间重用技术实现空间重用，使环上的带宽得到更为有效的利用**。RPR技术具有空间复用、自动拓扑识别、带宽公平机制和拥塞控制机制、物理层介质独立等特点。*(下面是缺点)*
8. <font color="red">设备投资比单核心局域网结构的投资高。</font>
9. <font color="red">核心路由的冗余设计难度较高，容易形成路由环路。</font>

### 层次化网络设计/三层组网架构

![image-20250321225536868](https://img.yatjay.top/md/20250321225536911.png)

#### 层次局域网结构特点

1. 核心层实现<font color="red">高速数据转发</font>
2. 汇聚层实现丰富的接口和接入层之间的<font color="red">互访控制</font>如ACL
3. 接入层实现<font color="red">用户接入</font>。
4. 网络拓扑结构**故障定位可分级**，便于维护。
5. **网络功能清晰**，有利于发挥设备的最大效率。
6. 网络拓扑**有利于扩展**。

#### 层次化网络模型的优点

1. <font color="red">网络成本降到最低</font>：通过在不同层次设计特定的网络互连设备，可以避免为各层中不必要的特性花费过多的资金。
2. <font color="red">实现不同层次上的模块化</font>：易于理解，使得故障隔离程度得到提高，保证了网络的稳定性
3. <font color="red">网络的改变变得更加容易</font>：当网络中的一个网元需要改变时）升级的成本限制在整个网络中很小的一个子集中，对网络的整体影响达到最小

#### 三层组网架构

- 接入层交换机：接入层是工作站连接网络的入口，实现用户的网络<font color="red">访问控制</font>**【MAC地址过滤】**，这一层的交换机应该以低成本提供<font color="red">高密度的接入端口</font>。
- 汇聚层交换机：汇聚层将网络<font color="red">划分为多个广播/组播域</font>，可以实现VLAN间的路由选择，并通过访问控制列表实现<font color="red">分组过滤</font>。这一层交换机的端口数量和交换速率要求不是很高，但应提供第三层交换功能。同时进行**服务质量(QoS)管理和速度限制**，以及**安全访问控制列表、组播管理和IP路由**。
- 核心层交换机：核心层应采用可扩展的高性能交换机组成园区网的主干线路，提供**链路冗余、路由冗余、VLAN中继和负载均衡等功能**，并且与汇聚层交换机具有兼容的技术，支持相同的协议。

#### 层次化网络模型原则

(不需要背，考到能够反映上来就行)

1. 在设计时，设计者应该尽量控制层次化的程度，一般情况下，有核心层、汇聚层和接入层<font color="red">3个层次就足够了</font>，过多的层次会导致整体网络性能的下降，并且会提高网络的延迟，同时也不方便进行网络故障排查和文档编写。
2. 在接入层应当保持**对网络结构的严格控制**，接入层的用户总是为了获得更大的外部网络访问带宽而随意申请其他的渠道访问外部网络，这是不允许的。
3. 为了保证网络的层次性，<font color="red">不能在设计中随意加入额外连接</font>，额外连接是指打破层次性，在不相邻层间的连接，这些连接会导致网络中的各种问题，例如接入层直接接到核心，就会缺乏汇聚层的访问控制和数据包过滤等。
4. 在进行设计时，<font color="red">应当首先设计接入层</font>，根据流量负载、流量和行为的分析对上层进行更精细的容量规划，再依次完成各个上层的设计。先做底层，再做上层
5. 除了接入层以外的其他层次，应尽量采用<font color="red">模块化方式</font>，每个层次由多个模块或者设备集合构成，每个模块间的边界应非常清晰。

### 例题

#### 例题1

![image-20250321230121635](https://img.yatjay.top/md/20250321230121667.png)

解析：

- 数据压缩一般是在有专用路由器负责如WOC/SD-WAN
- 核心层、汇聚层尽量使用冗余连接

#### 例题2

![image-20250321230139664](https://img.yatjay.top/md/20250321230139719.png)

解析：

- 图中没有汇聚交换机，因此核心交换机承担汇聚交换机的功能，实现网络内各VLAN之间访问
- 接入交换机多采用三层交换机

#### 例题3

![image-20250321230154781](https://img.yatjay.top/md/20250321230154837.png)

#### 例题4

![image-20250321230204331](https://img.yatjay.top/md/20250321230204374.png)

解析：包过滤和策略路由设计是汇聚层功能

#### 例题5

![image-20250321230220355](https://img.yatjay.top/md/20250321230220398.png)

解析：

- 策略路由一般在汇聚层配置，故A错；
- 汇聚向核心层进行路由宣告时一般要进行子网聚合，精简核心层路由表，故B错；
- 核心层一般只负责高速转发，不涉及数据包过滤功能。
- 网络一般建议3个层次，过多的层次会影响生成树等协议工作，使网络延迟加大，且容易形成环路，从而降低网络整体性能。

#### 例题6

![image-20250321225917638](https://img.yatjay.top/md/20250321225917669.png)

解析：注意MAC地址过滤是接入层的功能
