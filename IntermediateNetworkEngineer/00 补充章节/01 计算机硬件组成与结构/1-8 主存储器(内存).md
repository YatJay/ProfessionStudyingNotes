# 1-8 主存储器(内存)

## 概念术语与理解

存储器是计算机系统中的记忆设备，用来存放程序和数据。

计算机中全部信息，包括输入的原始数据、计算机程序、中间运行结果和最终运行结果都保存在存储器中。
存储器分为：

- 寄存器
- Cache（高速缓冲存储器）
- 主存储器

- 辅存储器

**从下到上，速度越来越快，容量越来越小，成本越来越高**

## 存储器的存取方式

![image-20240330204606763](https://img.yatjay.top/md/image-20240330204606763.png)

- 主存储器每个可寻址单元有唯一地址且每个可寻址单元专有读/写装置，随时**根据地址**访问任何一个存储单元
- Cache高速缓存每个可寻址单元有唯一地址且每个可寻址单元专有读/写装置，**根据内容而非地址**来选择读写点

## 存储器的性能

- 存储容量
- 存取时间：
  - 对于随机存取(主存如内存条)，就是完成一次读/写所花的时间；
  - 对非随机存取(辅存如硬盘)，就是将读/写装置移动到目的位置所花的时间(注意：SSD固态硬盘已经不需要移动读写装置，而是类似于主存进行读写)
- 存储器带宽：每秒能访问的位数。通常存储器周期是纳秒级(ns)。
  - 计算公式是：$\frac{1}{存储器周期}×每周期可访问的字节数$。
  - 例如：存储器周期是200ns，每个周期可访问4B，则带宽=1s/200ns×(4Bx8)=160Mbps。



## 主存储器类型

1. RAM(Random-access Memory)：随机存储器，可读/写，只能暂存数据，断电后数据丢失。
   - SRAM：静态随机存储器，在不断电时信息能够一直保持，读写速度快，生产成本高，多用于容量较小的高速缓冲存储器，高速缓存Cache主要使用SRAM，也使用CAM
   - DRAM：动态随机存储器，需要定时刷新以维持信息不丢失，读写速度较慢，集成度高，生产成本低，多用于容量较大的主存储器，内存条使用DRAM
2. ROM(Read-Only Memory)：只读存储器，出厂前用掩膜技术写入，常用于存放BIOS和微程序控制。

3. PROM(Programmable ROM)：可编程ROM，只能够一次写入，需用特殊电子设备进行写入。
4. EPROM(Ereasable PROM)：可擦除的PROM，用某种方法可擦去信息，可写入多次。
5. E2PROM(Electrically-Erasable PROM)：电可擦除EPROM，可以写入，但速度慢。
6. 闪速存储器(Flash Memory)：其特性介于EPROM与E2PROM之间。但不能进行字节级别的删除操作，U盘即使用Flash
7. CAM(相联存储器)：CAM是一种特殊的存储器，是一种基于数据内容进行访问的存储设备。其速度比基于地址进行读写的方式要快，高速缓存Cache也使用CAM，交换机MAC地址表也是用CAM

## 主存/内存的组成部分

主存储器一般由(主要是以下5个组成部分)：

1. 地址寄存器

2. 数据寄存器

3. 存储体(最核心的部分)

4. 控制线路

5. 地址译码电路

   等部分组成。

![image-20240330204728015](https://img.yatjay.top/md/image-20240330204728015.png)

## 主存储器的组成与所需芯片数量计算

实际的存储器是由一片或多片存储器配以控制电路构成。其容量为W×B，W是存储单元(word，字)的数量，B表示每个word由多少bit（位）组成。

如果某一芯片规格为w×b，则组成 WxB 的存储器需要用$\frac{W * B}{w * b} = (\frac{W}{w}) * (\frac{B}{b})$个芯片。

![image-20240330204800284](https://img.yatjay.top/md/image-20240330204800284.png)

## 主存储器的地址编码与地址空间计算

主存储器(内存)采用随机存取方式，需对每个数据块进行编码，而在主存储器中，数据块是以字(word)为单位来标识的，即每个字一个地址，通常采用十六进制表示。

例如，内存地址编址从A4000H一CBFFFH，则表示内存空间有**[(CBFFF-A4000)+1] bit**，即28000Hbit，也就是换算成十进制的163840bit，等于160KB。

注意：

1. 上面式子中的 +1 操作
2. 存储中使用的进制为1024