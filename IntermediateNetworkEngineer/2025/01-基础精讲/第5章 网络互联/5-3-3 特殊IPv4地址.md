## 5-3 IPv4

### 5-3-3 特殊IPv4地址

#### IPv4地址分类

分类编制的 IPv4 地址分为A、B、C、D、 E 五类。 

A 类地址的网络号部分占8bit，比特主机号部分占24bit，比特网络号的最高位固定为0。 

B 类地址的网络号部分和主机号部分各占16bit，比特网络号的最高两位固定为10。 

C 类地址的网络号部分占 24 个bit，比特主机号部分占 8 个bit，比特网络号的最高三位固定为110。 

D 类地址是多播地址，其最高4位固定为1110。 E 类地址是保留地址，其最高4位固定为1111。

![image-20230320215540197](https://img.yatjay.top/md/image-20230320215540197.png)

注意：

1. 只有 A 类、 B 类和 C 类地址可分配给网络中的主机或路由器的各接口
2. 主机号为全0的地址是网络地址，不能分配给主机或路由器的各接口
3. 主机号为全 1 的地址是广播地址，不能分配给主机或路由器的各接口。

![image-20250225192604099](https://img.yatjay.top/md/20250225192604134.png)

#### 特殊的IPv4地址

##### 0.0.0.0

- 主机端：DHCP分配过程中，用**0.0.0.0表示本机**，比如主机DHCPDiscover广播报文源目地址和端口
  是UDP 的0.0.0.0:68 -> 255.255.255.255:67，即DHCPDiscover广播报文以0.0.0.0为源地址，广播地址为目的地址。

- 服务器端：**0.0.0.0表示本机所有IPv4地址**，如果某主机有两个IP地址，该主机一个服务监听的地址(即服务使用的地址)是0.0.0.0，那么通过两个IP地址都能够访问该服务，比如某主机Web服务地址:端口配置为0.0.0.0:80，该主机存在2张网卡，一张是10.1.1.1，另一张是192.168.1.1，那么当Web服务地址:端口配置为0.0.0.0:80时，通过10.1.1.1:80和192.168.1.1:80均能访问到该主机

- 路由：在路由当中，**0.0.0.0表示默认路由**，即当路由表中没有找到完全匹配路由的时候所对应的路由。

##### 255.255.255.255

受限广播地址，表示3层广播的目标地址，在同一个广播域范围内所有主机都会接收这个包，广播域的
范围可变，跟子网划分相关

##### 169.254.0.0/16

使用DHCP自动获取IP地址，当<font color="red">DHCP服务器发生故障</font>，或响应时间超时，系统会为你分配这样一个地址，不能正常上网，即DHCP失败时获取到的地址

##### 127.0.0.0/8 (127.0.0.1-127.255.255.255)

本地环回地址，能ping通127地址，证明TCP/IP协议栈正常，即127开头，后面随意

##### RFC-1918私有IP地址

IPv4地址空间中有一部分特殊的地址，成为私有IP地址，私有IP地址不能直接访问公网（Internet）的
IP，只能在本地使用。

<font color="red">A类：10.0.0.0/8(10.0.0.1~10.255.255.255) </font>这些地址是1个A类网络即10.x.x.x/8

<font color="red">B类：172.16.0.0/12 (172.16.0.1~ 172.31.255.255) </font>这些地址是16个B类网络即172.16.x.x到172.31.x.x

<font color="red">C类： 192.168.0.0/16 (192.168.0.1 ~ 192.168.255.255) </font>这些地址是256个C网络即192.168.0.x到192.168.255.x

##### 常见组播地址

| **组播地址**                       | **用途**                                                     |
| ---------------------------------- | ------------------------------------------------------------ |
| 224.0.0.1                          | 所有主机                                                     |
| 224.0.0.2                          | 所有路由器                                                   |
| <font color="red">224.0.0.5</font> | <font color="red">所有运行OSPF的路由器</font>                |
| <font color="red">224.0.0.6</font> | <font color="red">OSPF DR（指定路由器）和BDR（备份指定路由器）的组播接收地址</font> |
| <font color="red">224.0.0.9</font> | <font color="red">RIPv2组播更新地址</font>                   |
| 224.0.0.18                         | VRRP（虚拟路由冗余协议）组播地址                             |

#### 例题

##### 例题1

![image-20250225200833674](https://img.yatjay.top/md/20250225200833721.png)

解析：

- 自动专用地址即DHCP失败后使用的地址即169.254.0.0/16
- 当接收不到DHCP服务器分配的IP地址时分配的IP地址

##### 例题2

![image-20250225200846606](https://img.yatjay.top/md/20250225200846640.png)

解析：注意私有地址确切范围

##### 例题3

![image-20250225200900015](https://img.yatjay.top/md/20250225200900050.png)

解析：

- RIP路由信息协议基于跳数，OSPF基于带宽
- RIPv1使用广播方式进行路由更新；RIPv2使用组播方式进行路由更新，其组播地址为224.0.0.9