## 6-10 IDS和IPS

### IDS定义与功能

入侵检测IDS是防火墙之后的<font color="red">第二道安全屏障</font>。(防火墙相当于小区门口保安，IDS相当于小区内部巡逻人员)

从计算机网络系统中的若干关键点<font color="red">收集信息</font>，并<font color="red">分析</font>这些信息，在<font color="red">不影响网络性能</font>(旁挂部署，不影响网络性能)的情况下能对网络进行监测，扩展了系统管理员的安全管理能力(包括安全审计、监视、攻击识别和响应)

入侵检测系统主要功能：

1. <font color="red">监测并分析</font>用户和系统的网络活动。
2. 匹配特征库，<font color="red">识别已知</font>的网络攻击、信息破坏、有害程序和漏洞等攻击行为。
3. 统计<font color="red">分析异常</font>行为。
4. 发现异常行为时，可**与防火墙联动，由防火墙对网络攻击行为实施阻断**。(IDS自己只能发现，不能阻断，阻断要联动其他设备一起)

### 入侵检测系统的数据源

入侵检测系统IDS数据源

- 操作系统审计记录，操作系统<font color="red">日志</font>，交换机日志等

- <font color="red">网络数据</font>：核心交换机端口镜像，服务器接入交换机<font color="red">端口镜像</font>(将一些端口的流量复制一份扔给IDS分析)

![image-20250309090322095](https://img.yatjay.top/md/20250309090322129.png)

#### 华为交换机端口镜像配置

将交换机网口`Gigabit Ethernet 1/0/2`的流量镜像到部署Snort的网口`Gigabit Ethernet 1/0/1`上。

```bash
<HUAWEI> system-view//进入系统模式
[HUAWEl] observe-port 1 interface gigabitethernet 1/0/1   //定义索引接口号为1的观察端口g1/0/1，索引接口号是一个逻辑接口

[HUAWEl] interface gigabitethernet 1/0/2          //进入流量采集接口
[HUAWEl-GigabitEthernet0/0/2] port-mirroring to observe-port 1 inbound   //将g1/0/2入方向的流量镜像到g1/0/1
```

#### 入侵检测分类

按信息来源分：HIDS、NIDS、DIDS（主机/网络/分布式）。

按响应方式分：实时检测和非实时检测。

按数据分析技术和处理方式分：**异常检测、误用检测和混合检测**。

- 异常检测：**建立**并不断更新和维护系统**正常行为的轮廓，定义报警阈值**，超过阈值则报警。<font color="red">能够检测从未出现的攻击，但误报率高</font>。

- 误用检测：对**已知的入侵行为**特征进行提取，形成**入侵模式库，匹配则进行报警**。<font color="red">已知入侵检测准确率高，对于未知入侵检测准确率低，高度依赖特征库</font>。

  检测技术：专家系统和模式匹配。

### 入侵防御系统IPS

定义：入侵防御系统是一种抢先的网络安全检测和防御系统，**能检测出攻击并积极响应**。

IPS集成入侵威胁特征库，**对网络流量进行检测，当发现异常流量时**，可以<font color="red">实时阻断</font>，实现入侵防护。

通常入侵防御系统具有如下功能:

1. <font color="red">监测并分析</font>用户和系统的网络活动。
2. 匹配特征库，识别已知的网络攻击、信息破坏、有害程序和漏洞等攻击行为，并<font color="red">阻断攻击</font>。
3. 统计分析异常行为。

IPS检测技术更加丰富多样，常见的有<font color="red">基于特征的匹配技术、协议分析技术、抗DoS/DDoS技术、智能化检测技术、蜜罐技术</font>（这是一种主动防御技术）等。

由于IPS<font color="red">串行部署</font>，也可能存在<font color="red">单点故障、性能瓶颈、漏报误报</font>等问题，同时还需要保持特征库更新。

### 入侵防御系统IPS对比入侵检测系统IDS

<font color="red">部署位置不同</font>：

- IPS一般串行部署
- IDS一般旁路部署。

<font color="red">入侵响应能力不同</font>：

- IPS能检测入侵，并能**阻断**
- IDS只能检测记录日志，发出警报。

![image-20250309090916153](https://img.yatjay.top/md/20250309090916183.png)

### 例题

#### 例题1

![image-20250309090938743](https://img.yatjay.top/md/20250309090938781.png)

解析：

- A为防火墙功能：实现内外网隔离与访问控制
- C为NAT：隐藏内部网络拓扑
- D中IDS不能消除病毒，只能对进出网络的信息进行实时监测与比对，及时发现攻击行为

#### 例题2

![image-20250309091026758](https://img.yatjay.top/md/20250309091026796.png)

解析：异常检测、误用检测（专家系统和模式匹配）和混合检测。

#### 例题3

![image-20250309091035270](https://img.yatjay.top/md/20250309091035307.png)

解析：IDS入侵检测系统与IPS入侵防御系统最主要的2点差异如下：

- IDS只能检测，不能阻断攻击。
- IDS一般旁路部署，IPS串行部署

另外，ABD可以作为案例题的答案
