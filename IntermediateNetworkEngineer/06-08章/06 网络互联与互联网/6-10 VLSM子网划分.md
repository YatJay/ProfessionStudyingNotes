# 6-10 VLSM子网划分

VLSM（可变长度子网掩码，Variable Length Subnet Mask）是一种IP地址划分技术，它允许网络管理员根据实际需要为不同的网络或子网分配不同长度的子网掩码。这种方法提供了更灵活的IP地址分配，可以更有效地利用IP地址空间，尤其是在IP地址资源紧张的情况下。

## 划分子网的引入

![image-20230913225258848](https://img.yatjay.top/md/image-20230913225258848.png)

假设一个公司网络内有500台主机

- 分配一个C类网络IP地址，则可分配给主机使用的IP地址共计2^8^-2=253个，不够用
- 分配一个B类网络IP地址，则可分配给主机使用的IP地址共计2^16^-2=65534个，又会造成极大浪费

为了解决一下问题：

- 标准ABC类网络问题
- IP地址空间浪费
- 一个广播域中PC数量庞大，造成广播风暴，网络可能被广播报文消耗大量资源

对一个`172.16.0.0/16`这样一个B类地址，还可以进行如下的子网划分（即借主机位中的8位作为子网号）

- 子网1：172.16.1.0/24
- 子网2：172.16.2.0/24
- 子网3：172.16.3.0/24
- ……

![image-20230913225736224](https://img.yatjay.top/md/image-20230913225736224.png)

## 如何进行子网划分——网络位向主机位借位

假设我们有一个`172.16.0.0/16`这样一个B类地址，则对于`172.16.0.0`这个网络，拥有2^16^=65535个IP地址

![image-20230913225920530](https://img.yatjay.top/md/image-20230913225920530.png)

**网络位向主机位借位**，从而使得网络部分的位数加长

![image-20230913230219740](https://img.yatjay.top/md/image-20230913230219740.png)

### 子网划分示例

#### 示例1

将192.168.1.0/24这个C类地址进行子网划分，网络位向主机位借1位

- 子网1：192.168.1.0/25
  - 网络地址：192.168.1.(0000 0000)即192.168.1.0
  - 起始地址：192.168.1.(0000 0001)即192.168.1.1
  - 最大地址：192.168.1.(0111 1110)即192.168.1.126
  - 广播地址：192.168.1.(0111 1111)即192.128.1.127（2^7^-1=128-1=127）
- 子网2：192.168.1.127/25
  - 网络地址：192.168.1.(1000 0000)即192.168.1.128
  - 起始地址：192.168.1.(1000 0001)即192.168.1.129
  - 最大地址：192.168.1.(1111 1110)即192.168.1.254
  - 广播地址：192.168.1.(1111 1111)即192.128.1.255

![image-20230913230407663](https://img.yatjay.top/md/image-20230913230407663.png)

可以分析两个子网的网络号、广播号

将192.168.1.0/24这个C类地址进行子网划分，网络位向主机位借1位

![image-20230913230506039](https://img.yatjay.top/md/image-20230913230506039.png)

#### 示例2

![image-20230913231338038](https://img.yatjay.top/md/image-20230913231338038.png)

172.x.x.x为C类IP地址，默认掩码为24位，这里借3位主机号来划分子网，可划分成8个子网

（注意上图中第三行应为广播号而非网络号）

### <font color=red>子网数量及每个子网的主机数量</font>

![image-20230913231829359](https://img.yatjay.top/md/image-20230913231829359.png)

## 公有IP和私有IP

IPv4地址空间中有一部分特殊的地址，称之为私有IP地址，私有IP地址不能直接访问公网（因特网）的IP，只能在本地使用（RFC 1918文档定义）

若需访问则需在网络出口处做NAT网络地址转换，转换为公网IP

![image-20230913232038333](https://img.yatjay.top/md/image-20230913232038333.png)

>  私网地址（Private Network Address）是一组在互联网上不直接路由的IP地址范围，它们被保留用于私有网络内部使用，如家庭、企业或组织的内部网络。这些地址在互联网上不可用，因此不会与全球唯一的公网IP地址发生冲突。私网地址的使用可以减少对公网IP地址的需求，提高IP地址的利用率。
>
> 根据RFC 1918（Request for Comments）的规定，私网地址包括以下几个范围：
>
> 1. **A类私网地址**：
>    - 10.0.0.0 至 10.255.255.255
>    - 这个范围内的IP地址被划分为A类地址，其中网络部分是前8位（10.0.0.0），主机部分是后24位（0.0.0.0至255.255.255）。
>
> 2. **B类私网地址**：
>    - 172.16.0.0 至 172.31.255.255
>    - 这个范围内的IP地址被划分为B类地址，其中网络部分是前16位（172.16.0.0至172.31.255.255），主机部分是后16位（0.0.0.0至255.255.255）。
>
> 3. **C类私网地址**：
>    - 192.168.0.0 至 192.168.255.255
>    - 这个范围内的IP地址被划分为C类地址，其中网络部分是前24位（192.168.0.0至192.168.255.255），主机部分是后8位（0.0.0.0至255.255.255）。
>
> 这些私网地址范围允许网络管理员在内部网络中自由分配IP地址，而不必担心与外部网络的地址冲突。在实际应用中，这些地址通常与网络地址转换（NAT）技术一起使用，使得私有网络中的设备可以通过一个或多个公网IP地址与互联网通信。这样，即使内部网络中的设备拥有私网地址，它们也能够访问互联网资源。