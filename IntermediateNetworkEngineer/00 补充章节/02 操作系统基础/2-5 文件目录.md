# 2-5 文件目录

## 文件存储空间管理

位图法(考试考察这种方法)：用一个向量(位数组)描述整个磁盘，**每一位表示一个物理块的状态**，如下面的位示图，图中1表示该物理块已经被使用，图中0表示该物理块未被使用。考察方式见例题1，理解到会做该题即可

![image-20240408231313639](https://img.yatjay.top/md/image-20240408231313639.png)

> 操作系统中的位图法（Bitmap）是一种用于管理磁盘或内存等存储空间的有效方法。该方法利用一个位数组（bit array）来表示整个存储空间的分配状态，其中数组的每个位（bit）对应着存储空间中的一个固定大小的单元，如磁盘的一个扇区或内存的一个页。
>
> **工作原理：**
>
> 1. **初始化：** 在位图创建之初，会根据存储设备的总容量确定位图的大小。例如，若每个物理块大小是一个字节，而存储设备有1024个块，则位图至少需要128个字节（因为1024个块对应1024位，通常按字节对齐，所以需要128个字节来存储这些位）。
>
> 2. **分配：** 当需要分配一个新的物理块时，操作系统会在位图中找到一个置为0的位（代表未被分配的块）。找到后将其设置为1，表示这个块已被分配出去，并记录下该块对应的物理地址。
>
> 3. **回收：** 当某个物理块不再使用时，操作系统会把位图中相应位置的位由1改回0，以标志这块空间重新变为可用状态。
>
> **优点：**
> - **简单高效**：查找和分配存储块的操作可以通过简单的位操作完成，速度快。
> - **空间利用率高**：当存储块较小且数量巨大时，相比于其他复杂的数据结构，位图法能更节省存储空间来记录分配状态。
> - **易于合并与分配连续空间**：虽然位图本身不直接支持连续空间分配，但可以根据位图快速判断并找到连续的一段空闲空间。
>
> **缺点：**
> - **空间开销**：当存储单元非常小，而总量又非常大时，位图可能会占据较大的连续内存空间。
> - **不适合大块分配**：如果经常需要分配较大连续空间，位图法需要额外算法来处理这种需求，不如链表或其他方法直观。
> - **碎片问题**：随着时间推移，由于分配和回收的随机性，可能会产生外部碎片，即存在多个分散的小块无法合并成大的连续空闲区域。
>
> 总之，位图法在现代操作系统和文件系统中被广泛应用，尤其适用于大量细粒度存储单元的分配管理场景。

### 例题

![image-20240408231329636](https://img.yatjay.top/md/image-20240408231329636.png)

解析：

- 磁盘容量为300GB，物理块大小1MB，则磁盘共300\*1024 / 1=307200个物理块

- 位示图**用每1位表示1个磁盘块**的使用情况，需要用307200个 位 来表示

- 1个字是32位，所以1个字可以表示32块物理块使用情况，那么需要307200/32＝9600个字

![image-20240408231340775](https://img.yatjay.top/md/image-20240408231340775.png)

解析：

- 300DPI表示表示**每英寸点数**为300

- 3x4英寸，需要各自计算水平和垂直方向的像素数

  > 使用图像扫描仪以300DPI（每英寸300点）的分辨率扫描一幅3x4英寸的图片，可以得到的像素总数计算方法是：
  >
  > 水平方向像素数 = DPI × 图片宽度（英寸）
  > 垂直方向像素数 = DPI × 图片高度（英寸）
  >
  > 所以，
  > 水平方向像素数 = 300 × 3 = 900像素
  > 垂直方向像素数 = 300 × 4 = 1200像素
  >
  > 因此，扫描得到的数字图像像素是 900x1200 像素。

> 300DPI (Dots Per Inch) 表示**每英寸点数**为300，这是一种衡量图像分辨率或打印、扫描精度的标准单位。具体来说：
>
> 1. 在打印领域：
>    - 300DPI意味着打印机在每英寸长度上可以打印300个单独的墨点，因此它提供了较高的打印细节和清晰度。对于高质量的打印任务，比如照片打印或专业文档打印，300DPI通常是标准的最低要求，因为它能够确保图像在近距离观察下具有良好的细节表现和较少的颗粒感。
>
> 2. 在扫描领域：
>    - 300DPI也用于描述扫描仪的光学分辨率，即扫描仪每英寸能够捕捉到300个像素点。这意味着扫描得到的图像将具有足够的细节，以便在同样300DPI或更高分辨率的打印机上输出时保持原始的清晰度。
>
> 3. 对于图像文件：
>    - 如果一张图像的分辨率被设置为300DPI，这意味着在理想情况下，每一英寸图像包含300像素。这有助于计算图像在特定物理尺寸下的正确打印尺寸，以及保证在打印时图像不会因放大而失真。
>
> 总结起来，300DPI是一个关于图像细节密度的重要参数，在打印、扫描和图形设计中都扮演着关键角色，它是衡量图像质量和打印效果好坏的重要指标。

## 文件目录

Windows：`C:\windows\system32\test.txt`    以某个盘符为根

Linux：`/etc/test.txt`   只有一个根目录

绝对路径：完整访问路径

相对路径：从当今路径出发的访问路径，**调用速度快**

### 例题

![image-20240408231429825](https://img.yatjay.top/md/image-20240408231429825.png)

解析：相对路径访问效率较高

![image-20240408231441860](https://img.yatjay.top/md/image-20240408231441860.png)

解析：略

# 本章总结

- 进程三态模型：**就绪、运行、阻塞**
- 同步和互斥，PV操作、**死锁**(记公式)
- 文件系统(**绝对路径、相对路径**)、位示图、图片容量计算