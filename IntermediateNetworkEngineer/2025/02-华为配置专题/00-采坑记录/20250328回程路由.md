路由是有来有回的过程，当模拟网络环境互ping时不通，可以考虑是否有回程路由

如下图所示简单网络拓扑，模拟互联网使用了ensp中的“云”，将虚拟网络拓扑桥接至物理网络，使用的本地物理网卡是手动添加的一张`Microsoft KM-TEST 环回适配器`网卡

![image-20250329002013301](https://img.yatjay.top/md/20250329002013357.png)

在PC和路由器接口配置好IP地址之后，使用PC去ping 1.1.1.1，发现不通，排查如下：

- PC ping各自网关192.168.2.254互相ping都是通的，说明数据到路由器这段是通的
- 路由器和1.1.1.1互相ping都是通的，说明路由器到回环网卡这段是通的
- 考虑回程路由的问题
  - PC的数据到达路由器，由于1.1.1.0网段是路由器直连网段，自然能够转发出去到达回环网卡
  - 数据到达回环网卡之后，由于此时物理机并没有更新到路由表，而且我们事先没有为回环网卡配置网关，回环网卡不知道将回包发到哪里
  - 此时将回环网卡的网关地址配置为1.1.1.254，指回路由器出口地址
- 之后再次测试PC和1.1.1.1互ping，是通的

查看物理机的路由表，发现已经为1.1.1.0网段添加了默认路由

![image-20250329010213867](https://img.yatjay.top/md/20250329010213919.png)

删除回环网卡的网关之后，发现路由表该条默认路由消失

![image-20250329010434847](https://img.yatjay.top/md/20250329010434890.png)

也可用为物理机添加一条静态路由，将发往1.1.1.0网段的数据包的网关指向1.1.1.254

### 指定源地址的ping命令

```
ping -S 1.1.1.1 192.168.3.100
```

windows上的tracert和pathping无法指定源地址，可以将其他网卡禁用之后，使用这两个命令测试是否能够跟踪到192.168.3.100服务器